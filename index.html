<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ—Ç–æ–≤ Tele2</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f6fa;
            color: #333;
            line-height: 1.4;
        }
        .app-container {
            max-width: 100%;
            padding: 12px;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        .header h1 {
            font-size: 18px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        .controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px;
        }
        .btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }
        .tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            font-weight: 500;
            font-size: 13px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .tab.active {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
        }
        .content {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .table-container {
            overflow-x: auto;
            margin: 0 -15px;
            padding: 0 15px;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 700px;
        }
        .table th {
            background: #f8f9fa;
            color: #667eea;
            padding: 10px 6px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
            white-space: nowrap;
        }
        .table td {
            padding: 8px 6px;
            border-bottom: 1px solid #e9ecef;
            white-space: nowrap;
        }
        .table tr:last-child td {
            border-bottom: none;
        }
        .table tr:hover {
            background: #f8f9fa;
        }
        .status-active {
            color: #27ae60;
            font-weight: 600;
            font-size: 11px;
        }
        .status-bought {
            color: #e74c3c;
            font-weight: 600;
            font-size: 11px;
        }
        .id-copy {
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
            padding: 2px 4px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .id-copy:hover {
            background: #f0f3ff;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #667eea;
        }
        .stat-value {
            font-size: 16px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 2px;
        }
        .stat-label {
            font-size: 11px;
            color: #7f8c8d;
        }
        .profit-section {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #c3e6cb;
        }
        .profit-title {
            font-size: 13px;
            font-weight: 600;
            color: #155724;
            margin-bottom: 8px;
            text-align: center;
        }
        .profit-value {
            font-size: 20px;
            font-weight: 700;
            color: #155724;
            text-align: center;
            margin: 8px 0;
        }
        .profit-formula {
            font-size: 11px;
            color: #155724;
            text-align: center;
            opacity: 0.8;
        }
        .redemption-input-section {
            background: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #ffeaa7;
        }
        .input-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .redemption-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }
        .save-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }
        .daily-stats {
            background: #e3f2fd;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #bbdefb;
        }
        .daily-stats-title {
            font-size: 13px;
            font-weight: 600;
            color: #1565c0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .daily-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        .daily-stat {
            background: rgba(255, 255, 255, 0.7);
            padding: 8px;
            border-radius: 6px;
            text-align: center;
        }
        .daily-stat-value {
            font-size: 14px;
            font-weight: 700;
            color: #1976d2;
        }
        .daily-stat-label {
            font-size: 10px;
            color: #546e7a;
        }
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            z-index: 1000;
            font-size: 14px;
            display: none;
            backdrop-filter: blur(10px);
        }
        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #7f8c8d;
        }
        .empty-state-icon {
            font-size: 40px;
            margin-bottom: 10px;
            opacity: 0.5;
        }
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="notification" id="copyNotification">‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä</div>
    
    <div class="app-container">
        <div class="header">
            <h1>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ—Ç–æ–≤ Tele2</h1>
            <div class="controls">
                <button class="btn" onclick="loadRealData()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button class="btn" onclick="showTab('stats')">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('active')">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
            <button class="tab" onclick="showTab('bought')">–ò—Å—Ç–æ—Ä–∏—è</button>
            <button class="tab" onclick="showTab('stats')">–û—Ç—á–µ—Ç</button>
        </div>
        
        <div class="content">
            <!-- –í–∫–ª–∞–¥–∫–∞ –ê–∫—Ç–∏–≤–Ω—ã–µ -->
            <div id="active-tab" class="tab-content active">
                <div class="section-title">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ –ª–æ—Ç—ã</div>
                <div class="table-container">
                    <div id="active-table-container">
                        <div class="empty-state">
                            <div class="empty-state-icon">üìã</div>
                            <div>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                        </div>
                    </div>
                </div>
                
                <div class="daily-stats">
                    <div class="daily-stats-title">üìä –°–µ–≥–æ–¥–Ω—è—à–Ω—è—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                    <div class="daily-stats-grid">
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="today-active-count">0</div>
                            <div class="daily-stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–æ–≤</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="today-active-sum">0 —Ä—É–±</div>
                            <div class="daily-stat-label">–°—É–º–º–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="today-bought-count">0</div>
                            <div class="daily-stat-label">–ö—É–ø–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="today-bought-sum">0 —Ä—É–±</div>
                            <div class="daily-stat-label">–°—É–º–º–∞ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –ö—É–ø–ª–µ–Ω–Ω—ã–µ -->
            <div id="bought-tab" class="tab-content">
                <div class="section-title">üî¥ –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫</div>
                <div class="table-container">
                    <div id="bought-table-container">
                        <div class="empty-state">
                            <div class="empty-state-icon">üïí</div>
                            <div>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div id="stats-tab" class="tab-content">
                <div class="section-title">üìà –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-active-count">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-active-sum">0 —Ä—É–±</div>
                        <div class="stat-label">–°—É–º–º–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-bought-count">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∫—É–ø–ª–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-bought-sum">0 —Ä—É–±</div>
                        <div class="stat-label">–°—É–º–º–∞ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö</div>
                    </div>
                </div>
                
                <div class="redemption-input-section">
                    <div style="font-size: 12px; color: #856404; margin-bottom: 8px; font-weight: 600;">
                        üí∞ –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏
                    </div>
                    <div class="input-group">
                        <input type="number" id="redemption-percent" class="redemption-input" 
                               min="0" max="100" value="0" placeholder="–í–≤–µ–¥–∏—Ç–µ % –≤—ã–∫—É–ø–∞">
                        <button class="save-btn" onclick="saveRedemptionRate()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                    <div style="font-size: 10px; color: #856404; margin-top: 6px;">
                        –ü—Ä–∏–±—ã–ª—å = (–°—É–º–º–∞ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö √ó % –≤—ã–∫—É–ø–∞) / 100
                    </div>
                </div>
                
                <div class="profit-section">
                    <div class="profit-title">üéØ –†–∞—Å—á–µ—Ç–Ω–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    <div class="profit-value" id="profit-amount">0 —Ä—É–±</div>
                    <div class="profit-formula" id="profit-formula">
                        –ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–∫—É–ø–∞
                    </div>
                </div>
                
                <div class="daily-stats">
                    <div class="daily-stats-title">üìÖ –û–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</div>
                    <div class="daily-stats-grid">
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="stats-today-active-count">0</div>
                            <div class="daily-stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="stats-today-active-sum">0 —Ä—É–±</div>
                            <div class="daily-stat-label">–°—É–º–º–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="stats-today-bought-count">0</div>
                            <div class="daily-stat-label">–ö—É–ø–ª–µ–Ω–æ</div>
                        </div>
                        <div class="daily-stat">
                            <div class="daily-stat-value" id="stats-today-bought-sum">0 —Ä—É–±</div>
                            <div class="daily-stat-label">–°—É–º–º–∞ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let appData = null;
        let currentRedemptionRate = 0;
        
        function showTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // –î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ
            event.target.classList.add('active');
            
            // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –æ–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (appData) {
                renderTabData(tabName);
            }
        }
        
        function renderTabData(tabName) {
            switch(tabName) {
                case 'active':
                    renderTable('active-table-container', appData.active_lots);
                    updateTodayStats();
                    break;
                case 'bought':
                    renderTable('bought-table-container', appData.bought_lots);
                    break;
                case 'stats':
                    updateStats();
                    updateTodayStats();
                    break;
            }
        }
        
        function updateStats() {
            if (!appData) return;
            
            document.getElementById('total-active-count').textContent = appData.stats.active_count;
            document.getElementById('total-active-sum').textContent = appData.stats.active_sum + ' —Ä—É–±';
            document.getElementById('total-bought-count').textContent = appData.stats.bought_count;
            document.getElementById('total-bought-sum').textContent = appData.stats.bought_sum + ' —Ä—É–±';
            
            calculateProfit();
        }
        
        function updateTodayStats() {
            if (!appData) return;
            
            const today = new Date().toISOString().split('T')[0];
            const todayBoughtLots = appData.bought_lots.filter(lot => lot.purchase_date === today);
            const todayBoughtCount = todayBoughtLots.length;
            const todayBoughtSum = todayBoughtLots.reduce((sum, lot) => sum + (lot.amount || 0), 0);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –ê–∫—Ç–∏–≤–Ω—ã–µ
            document.getElementById('today-active-count').textContent = appData.stats.active_count;
            document.getElementById('today-active-sum').textContent = appData.stats.active_sum + ' —Ä—É–±';
            document.getElementById('today-bought-count').textContent = todayBoughtCount;
            document.getElementById('today-bought-sum').textContent = todayBoughtSum + ' —Ä—É–±';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('stats-today-active-count').textContent = appData.stats.active_count;
            document.getElementById('stats-today-active-sum').textContent = appData.stats.active_sum + ' —Ä—É–±';
            document.getElementById('stats-today-bought-count').textContent = todayBoughtCount;
            document.getElementById('stats-today-bought-sum').textContent = todayBoughtSum + ' —Ä—É–±';
        }
        
        function calculateProfit() {
            if (!appData) return;
            
            const redemptionRate = currentRedemptionRate;
            const boughtSum = appData.stats.bought_sum;
            const profit = (boughtSum * redemptionRate) / 100;
            
            document.getElementById('profit-amount').textContent = profit.toFixed(2) + ' —Ä—É–±';
            document.getElementById('profit-formula').textContent = 
                `–ù–∞ –æ—Å–Ω–æ–≤–µ ${redemptionRate}% –æ—Ç ${boughtSum} —Ä—É–±`;
        }
        
        function saveRedemptionRate() {
            const input = document.getElementById('redemption-percent');
            const rate = parseFloat(input.value);
            
            if (!isNaN(rate) && rate >= 0 && rate <= 100) {
                currentRedemptionRate = rate;
                localStorage.setItem('redemption_rate', rate.toString());
                calculateProfit();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification('–ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ' + rate + '%');
            } else {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç (0-100)');
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä');
            }).catch(() => {
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä');
            });
        }
        
        function showNotification(message) {
            const notification = document.getElementById('copyNotification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }
        
        function renderTable(containerId, lots) {
            const container = document.getElementById(containerId);
            
            if (!lots || lots.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">${containerId.includes('active') ? 'üìã' : 'üïí'}</div>
                        <div>${containerId.includes('active') ? '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ—Ç–æ–≤' : '–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫'}</div>
                    </div>
                `;
                return;
            }
            
            let html = '<table class="table">';
            html += '<tr><th>ID</th><th>–°—Ç–∞—Ç—É—Å</th><th>–ù–æ–º–∏–Ω–∞–ª</th><th>–¶–µ–Ω–∞</th><th>–°–≥–æ—Ä–∞–Ω–∏–µ</th><th>–ò–∑–º–µ–Ω–µ–Ω</th><th>–ü—Ä–æ–¥–∞–≤–µ—Ü</th></tr>';
            
            lots.forEach(lot => {
                const statusClass = lot.original_status === 'active' ? 'status-active' : 'status-bought';
                const fullUrl = lot.url || `https://tele2.ru/exchange/lots/${lot.full_id || lot.id}`;
                
                html += `
                    <tr>
                        <td><span class="id-copy" onclick="copyToClipboard('${fullUrl}')" title="–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É">${lot.id}</span></td>
                        <td class="${statusClass}">${lot.status}</td>
                        <td>${lot.nominal}</td>
                        <td>${lot.price}</td>
                        <td>${lot.expiration}</td>
                        <td>${lot.changed}</td>
                        <td>${lot.name}</td>
                    </tr>
                `;
            });
            
            html += '</table>';
            container.innerHTML = html;
        }

        function loadRealData() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.querySelectorAll('.empty-state').forEach(container => {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <div>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                    </div>
                `;
            });

            // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ web_app_data.json
            fetch('web_app_data.json?' + new Date().getTime()) // –î–æ–±–∞–≤–ª—è–µ–º timestamp –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    appData = data;
                    renderTabData('active');
                    updateStats();
                    updateTodayStats();
                    document.getElementById('update-time').textContent = new Date().toLocaleString('ru-RU');
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã
                    localStorage.setItem('tele2_lots_data', JSON.stringify(data));
                    showNotification('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                    
                    // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage –∫–∞–∫ fallback
                    const savedData = localStorage.getItem('tele2_lots_data');
                    if (savedData) {
                        appData = JSON.parse(savedData);
                        renderTabData('active');
                        updateStats();
                        updateTodayStats();
                        showNotification('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                    } else {
                        // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤–æ–æ–±—â–µ
                        document.querySelectorAll('.empty-state').forEach(container => {
                            container.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-state-icon">‚ùå</div>
                                    <div>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                                    <div style="font-size: 11px; margin-top: 5px;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</div>
                                </div>
                            `;
                        });
                        showNotification('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
                    }
                });
        }
        
        function loadData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∫—É–ø–∞
            const savedRate = localStorage.getItem('redemption_rate');
            if (savedRate) {
                currentRedemptionRate = parseFloat(savedRate);
                document.getElementById('redemption-percent').value = currentRedemptionRate;
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadRealData();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadData();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
            setInterval(loadRealData, 120000);
        });
    </script>
</body>
</html>
